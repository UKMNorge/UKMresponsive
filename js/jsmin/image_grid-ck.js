function processPhotos(a,t){parent_container=jQuery(t),parent_container.parents("div.removePadding").css("padding","5px");var i=parent_container.find(".grid_load"),r=i.eq(0).innerWidth();if(null==r)return!1;var d=250,e=5,n=[];$.each(a,function(a,t){var i=parseInt(t.width,10),r=parseInt(t.height,10);r!=d&&(i=Math.floor(i*(d/r))),n.push(i)});for(var o=0,h=0,u=0,s=0;a.length>s;){h++;var l=jQuery("<div/>",{id:"row_"+h,"class":"album_row"});i.append(l),l.empty();for(var c=0,p=0;r>1.1*p&&void 0!=n[o+c];)p+=n[o+c]+2*e,c++;var m=r/p,g=0;p=0;for(var f=Math.floor(d*m);c>g;){var v=a[o+g],_=Math.floor(n[o+g]*m);p+=_+2*e;var b=$("<img/>",{"class":"album_image clickable",src:v.source,width:"auto",height:f,"data-link":v.link}).css("margin",e+"px"),w=$("<a/>",{href:v.link}).html(b);l.append(w),g++,s++}for(g=0;r>p;){var y=l.find("img:nth-child("+(g+1)+")");y.width(y.width()+1),g=(g+1)%c,p++}for(g=0;p>r;){var j=l.find("img:nth-child("+(g+1)+")");j.width(j.width()-1),g=(g+1)%c,p--}l.height(f+2*e),o+=c}parent_container.find(".stupid_load").hide(),parent_container.parents("div.removePadding").css("padding","0px")}jQuery(document).ready(function(){jQuery(".image_album").each(function(){image_album=jQuery(this),stupid_load=image_album.find("div.stupid_load"),grid_load=image_album.find("div.grid_load"),photos=new Array,stupid_load.find("img").each(function(){thumb=jQuery(this),photos.push({id:thumb.attr("data-id"),source:thumb.attr("data-source"),width:thumb.attr("data-width"),height:thumb.attr("data-height"),link:thumb.attr("data-source")})}),processPhotos(photos,"#"+image_album.attr("id"))})});